import formats/wasm/wase;
import formats/wasm/wasm_encode;

import sys/system;

main() {
	module = wase2wasm(
		WaseMemory(1, 0, "memory",
			WaseEmpty()
		)
	);

	bytes = wasmModule2bytes(module);
	
	setFileContentBytes("test_wase.wasm", 
		fold(bytes, "", \acc, byte -> {
			acc + fromCharCode(byte)
		})
	);

	startProcess("wasm2wat", ["test_wase.wasm", "-o", "test_wase.wat"], ".", "", \ec, so, se -> {
		println(ec);
		println(so);
		println(se);
		quit(0);
	});
}