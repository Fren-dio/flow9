import material/material2tropic;

main() {
	manager = makeMaterialManager([]);
	setRendererType("html");

	leftExpander = make(false);
	appBarHeight = make(0.);
	scrollPosition = makePoint();
	scrollMoving = make(false);

	content =
		MLines([
			MCols([
				MText("CONTENT", []),
				TFillX(),
				MText("RIGHT SIDE", [])
			]),
			// MTextButton("MODAL BOTTOM SHEET", \ -> nextDistinct(showModalBS, true), [], []),
			// MTextButton("LEFT", \ -> reverseBehaviour(leftExpander), [], []),
			// MTextButton("RIGHT", \ -> reverseBehaviour(rightExpander), [], []),
			MScroll(
				MLines([
					TRectangle([MFill(MBlack())], TFixed(20., 400.)),
					MTooltip(
						MText("aaaaaaaaaaaaaa", []),
						MText("bbbbbbbbbbbbbb", []),
						[]
					),
					TRectangle([MFill(MBlack())], TFixed(20., 400.))
				]),
				TFixed(400., 300.),
				[]
			),
			TRectangle([GradientFill(90.0, [GradientPoint(blue, 1.0, 0.0), GradientPoint(yellow, 1.0, 1.0),])], TFixed(100., 1000.)),
			// MIconButton("android", nop, [], [MTooltipText(const("tooltip text"))]),
			TRectangle([MFill(MBlack())], TFixed(20., 20.))
		])
		// |> MBorderTop(56.)
		// |> (\m -> MScroll(m, TFillXY(), [MScrollPosition(floatingToolbarScrollPosition), TScrollYMoving(floatingToolbarScrollMoving)]))
		|> (\m -> MBorderT(zero, appBarHeight, zero, zero, m))
		|> (\m -> MScroll(m, TFillXY(), [MScrollPosition(scrollPosition), TScrollYMoving(scrollMoving), TScrollDisableOutOfBounds(const(true))]))
		;

	toolbar = MToolbar(
		leftExpander,
		MText("TEXT", []),
		[],
		[]
	);
	isMobileView = false;

	leftSideMenuItemsB = make([
		MSingleLine("LINE 1", [MPrimaryAction(MIcon("android", [])), MOnClick(\ -> println("on click"))]),
		MSingleLine("LINE 2", [MPrimaryAction(MIcon("android", [])), MOnClick(\ -> println("on click"))]),
		MSingleLine("LINE 3", [MPrimaryAction(MIcon("android", [])), MOnClick(\ -> println("on click"))]),
		MSingleLine("LINE 4", [MPrimaryAction(MIcon("android", [])), MOnClick(\ -> println("on click"))]),
	]);

	lnavBarContent =
		MSideNav(
			MSNSmallHead([
				MText("HEAD", [])
			]),
			{
                niceLeftNavMenu =
                    MSelect(leftSideMenuItemsB, \leftItems ->
                        MList(
                            leftItems,
                            [
                            	MAddSeparators(), MListWidth(256., 256.),
                            	MListMinimize(fnot(leftExpander)), MListMinimizedWidth(56.)
                            ],
                            [MListSelection(const(true), false, false, make([]) /*selectedMenuIdsB*/)]
                        	// []
                        ) |> MBorderTop(0.)
                        |> (\l ->
                            MSelect(leftExpander, \e ->
                                if (e)
                                    MLines([l, MFillY(),
                                        // MZoomToFill(TPicture(getBaseAppUrl() + "images/logo_area9.png", []), TFixed(90., 65.), false)
                                        TRectangle([MFill(MGreen(200))], TFixed(20., 20.))
                                        |> MCenterX
                                    ])
                                else l
                            )
                        ),
                    );
                    if (!isMobileView)
                        niceLeftNavMenu
                    else
                        MIf(leftExpander, niceLeftNavMenu, MEmpty())
            },
			leftExpander,
			[]
		);


	lnavBar = MLeftNav(
		lnavBarContent,
		leftExpander,
		[
			MSideNavMini(),
		]
	);

	app = MAppStructure([
			MContent(content),
			MAppBar(toolbar),
			lnavBar,
		], [
			MFloatingToolbar(),
			MFloatingToolbarExternalScroll(appBarHeight, [MScrollPosition(scrollPosition), TScrollYMoving(scrollMoving)])
		])
	|> (\m -> MGroup2(TRectangle([MFill(MGreen(200))], TFillXY()), m))
	;

	scroll = MScroll(
				MLines([
					TRectangle([MFill(MBlack())], TFixed(20., 400.)),
					MTooltip(
						MText("aaaaaaaaaaaaaa", []),
						MText("bbbbbbbbbbbbbb", []),
						[]
					),
					TRectangle([MFill(MBlack())], TFixed(20., 400.))
				]),
				TFixed(400., 300.),
				[]
			);
	
	// mrender(manager, true, scroll);
	mrender(manager, true, app);
}