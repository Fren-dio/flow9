import tools/dsl/languages/lambda;
import tools/consonance/concert/concert;

import tools/dsl/dsl_api;

export {
    lambda2Concert(code : string) -> DslAst;
}

lambda2Concert(code : string) -> DslAst {
    lambda = defineLambda();
    grammar = lambda.grammar;

    rewrites = defineDslRewriting(grammar, grammar, ";", <<
		sum($a, $b) => makeNode("CEmpty", nil());
	>>, <<
        
    >>, 
    << 0 >>
	);

    concert = DslLanguage("concert", grammar, Some(rewrites), None(), None(),
        makeTree(), [], None()
    );
    parseDsl("concert-sample", concert, code)
}

main() {
    res = lambda2Concert(<<
        1 + 4
    >>);
    println(res);
    quit(0)
}