import tools/dsl/dsl_ast;
import text/blueprint;

export {
	prettyDsl(a : DslAst) -> string;
}

prettyDsl(a : DslAst) -> string {
	switch (a) {
		DslBool(value): b2s(value);
		DslInt(value): i2s(value);
		DslDouble(value): d2s(value);
		DslString(value): toString(value);
		DslList(value): superglue(list2array(value), prettyDsl, ",\n");
		DslNode(name, args, pos): {
			if (args == []) {
				name + "()"
			} else {
				blueprint("
					%name%(
						%args%
					)
				", [
					"name", name,
					"args", superglue(args, prettyDsl, ",\n")
				])
			}
		}
	}
}
