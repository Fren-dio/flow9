native map : ([?], (?) -> ??) -> [??] = Native.map;
native println2 : io (flow) -> void = Native.println;

IntVal(v : int);
Struct(val : ref IntVal);
Struct2(val : ref IntVal);

main() {
	println2("Create init array");
	arr = [Struct(ref IntVal(1)), Struct(ref IntVal(2)), Struct(ref IntVal(3))];
	println2("\nCreate array by map()");
	arr2 = map(arr, \v -> Struct2(v.val));
	arr2[0].val := IntVal(4);
	println2("\nPrint new array");
	println2(arr2);

	println2("\nEND");
}
