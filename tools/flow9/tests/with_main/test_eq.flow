native println2 : io (flow) -> void = Native.println;
native quit : io (code : int) -> void = Native.quit;

Un ::= A, B, C;

A(arg : int);
C(str : string);
B(left : Un, right : [Un]);

main() -> void {
	left = A(1);
	right = [C("a"), A(2), B(A(3), [])];
	B(left, right);
	println2("Test on deep equality ...");
	println2([2] == [2]);
	println2([1, 2, 3] == [1, 2, 3]);
	a = B(
		B(C("xyz"), [A(1), B(A(3), [C("A")])]), 
		[B(C("123"), [B(C("#"), [B(A(-1), [])]), A(5)]), A(123)]
	);
	b = B(
		B(C("xyz"), [A(1), B(A(3), [C("A")])]), 
		[B(C("123"), [B(C("#"), [B(A(-1), [])]), A(5)]), A(123)]
	);
	c = B(
		B(C("xyz"), [A(1), B(A(3), [C("A")])]), 
		[B(C("123"), [B(C("#"), [B(A(-2), [])]), A(5)]), A(123)]
	);
	println2(if (a == b) "true" else "false");
	println2(if (a == c) "true" else "false");


	d = B(
		B(C("xyz"), [A(1), B(A(3), [C("A")])]), 
		[B(C("123"), [B(C("#"), [B(A(-1), [])]), A(5)]), A(123)]
	);

	e = B(
		B(C("xyz"), [A(1), B(A(3), [C("A")])]), 
		[B(C("123"), [B(C("#"), [B(A(-1), [])]), A(6), A(5)]), A(123)]
	);
	println2(if (d == e) "true" else "false");
	quit(0);
}
